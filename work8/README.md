# csdn∑智谱の融合

## 项目背景  
为了提升CSDN平台的内容组织效率，我们开发了一款智能标签预测模型。借助深度学习与自然语言处理技术，本项目实现了高精度的自动化标签生成，测试集上的**F1_score高达0.97-0.98**，显著超越传统方法。

## 解决方案  
### 数据处理管道  
- **多层清洗**：实现了包括HTML标签移除、拼写检查与停用词过滤在内的三步清洗策略，为模型提供纯净的输入数据。  
- **语义向量化**：通过Sentence-BERT将文本转化为高维语义向量，相比传统方法具有更强的语义捕获能力。  

### 模型构建与训练  
1. **模型选择**  
   - 采用glm作为预训练模型基础，充分利用其对中文语料的深度理解能力。  
   - 增加一层分类头，针对标签预测任务进行定制化设计。  

2. **训练过程**  
   - **全量训练**：使用全量优化。  
   - **对比学习**：引入对比损失，优化文本语义分布，使相似文本更加贴近。  
   - **动态学习率**：采用OneCycle策略动态调整学习率，从而平衡初期探索和后期稳定收敛。  

### 推理优化  
- **分层推理架构**：通过冻结底层权重，只对分类头进行在线微调，降低实时推理的计算成本。  
- **批量预测**：实现批量推理逻辑，显著提升系统吞吐量，适用于高并发场景。  

## 项目成果  
- **精度与召回率提升**：在验证集中实现`Precision=0.98`，`Recall=0.96`，满足高要求的实际应用需求。  

## 使用说明  

### 环境准备  
确保Python环境版本为3.10，并执行以下命令安装必要依赖：  
```bash  
conda create -n tag python=3.10  
conda activate tag  
pip install -r requirements.txt
```

## 推理说明
推理使用文件目录下的`predict.py`，运行前记得修改第六行的模型路径。
